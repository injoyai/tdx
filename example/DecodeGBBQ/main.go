package main

import (
	"os"
	"time"

	"github.com/injoyai/logs"
	"github.com/injoyai/tdx/lib/gbbq"
)

func main() {
	//filename, err := gbbq.Download("./data/temp")
	//logs.PanicErr(err)

	filename := "./data/temp/gbbq/gbbq"
	bs, err := os.ReadFile(filename)
	logs.PanicErr(err)

	ss, err := gbbq.Decode(bs)
	logs.PanicErr(err)

	ls := ss.GetStocks()["000001"]
	for _, v := range ls {
		logs.Debug(v.Date.Format(time.DateTime), v.Float, v.Total)
	}
	logs.Debug("总数:", len(ls))
}

/*


和新浪数据差别还挺大的,整体大致对得上的
https://stock.finance.sina.com.cn/stock/api/jsonp.php/var%20KKE_ShareAmount_sz000001=/StockService.getAmountBySymbol?_=20&symbol=sz000001

/*<script>location.href='//sina.com';</script>*/ /*
var KKE_ShareAmount_sz000001=([{"date":"1991-04-03","amount":3710},{"date":"1991-08-17","amount":4823},{"date":"1991-12-31","amount":4975.9358},{"date":"1992-03-23","amount":7463.6625},{"date":"1992-12-31","amount":7464.9675},{"date":"1993-05-24","amount":13810.1899},{"date":"1993-07-05","amount":17912.2251},{"date":"1994-07-14","amount":26868.3376},{"date":"1994-08-22","amount":28659.5634},{"date":"1994-09-02","amount":29707.1479},{"date":"1995-09-27","amount":35721.1478},{"date":"1996-05-29","amount":71393.4984},{"date":"1997-08-27","amount":107090.2476},{"date":"1999-12-31","amount":107091.0021},{"date":"2000-12-08","amount":139218.3031},{"date":"2001-10-15","amount":140842.0232},{"date":"2004-12-30","amount":140936.1965},{"date":"2007-06-20","amount":155018.7787},{"date":"2007-12-28","amount":170327.061},{"date":"2008-01-21","amount":175682.0549},{"date":"2008-06-26","amount":204652.0536},{"date":"2008-06-27","amount":214200.4409},{"date":"2008-10-31","amount":278460.5731},{"date":"2009-06-19","amount":278459.3862},{"date":"2009-06-22","amount":292367.4599},{"date":"2009-06-30","amount":292375.6824},{"date":"2009-10-15","amount":292411.4263},{"date":"2010-06-25","amount":292411.4263},{"date":"2010-06-28","amount":310536.9975},{"date":"2010-06-30","amount":310536.7602},{"date":"2010-09-17","amount":310536.7602},{"date":"2010-12-31","amount":310535.8511},{"date":"2011-06-30","amount":310535.8672},{"date":"2011-08-05","amount":310535.8672},{"date":"2012-12-31","amount":310535.8022},{"date":"2013-06-14","amount":310535.8672},{"date":"2013-06-20","amount":496857.3875},{"date":"2013-11-12","amount":557590.1875},{"date":"2014-01-09","amount":557590.1875},{"date":"2014-06-06","amount":557588.2183},{"date":"2014-06-12","amount":669105.862},{"date":"2014-08-29","amount":669110.5775},{"date":"2014-09-01","amount":983671.215},{"date":"2015-04-13","amount":1180405.4579},{"date":"2015-05-21","amount":1180405.4579},{"date":"2016-03-25","amount":1180405.4579},{"date":"2016-05-20","amount":1180405.458},{"date":"2016-05-23","amount":1219265.0323},{"date":"2016-06-16","amount":1463118.0387},{"date":"2017-01-09","amount":1691798.9651},{"date":"2017-12-31","amount":1691798.3372},{"date":"2018-05-18","amount":1691799.879},{"date":"2018-05-21","amount":1717024.6773},{"date":"2019-06-30","amount":1717024.5848},{"date":"2019-08-07","amount":1717090.521},{"date":"2019-09-12","amount":1889141.5083},{"date":"2019-09-18","amount":1940575.268},{"date":"2020-12-31","amount":1940575.4475},{"date":"2021-12-31","amount":1940552.195},{"date":"2022-06-30","amount":1940554.695},{"date":"2024-06-30","amount":1940561.7528},{"date":"2024-12-31","amount":1940557.185},{"date":"2025-06-30","amount":1940560.0653}]);

[{
	"date": "1991-04-03",
	"amount": 3710
}, {
	"date": "1991-08-17",
	"amount": 4823
}, {
	"date": "1991-12-31",
	"amount": 4975.9358
}, {
	"date": "1992-03-23",
	"amount": 7463.6625
}, {
	"date": "1992-12-31",
	"amount": 7464.9675
}, {
	"date": "1993-05-24",
	"amount": 13810.1899
}, {
	"date": "1993-07-05",
	"amount": 17912.2251
}, {
	"date": "1994-07-14",
	"amount": 26868.3376
}, {
	"date": "1994-08-22",
	"amount": 28659.5634
}, {
	"date": "1994-09-02",
	"amount": 29707.1479
}, {
	"date": "1995-09-27",
	"amount": 35721.1478
}, {
	"date": "1996-05-29",
	"amount": 71393.4984
}, {
	"date": "1997-08-27",
	"amount": 107090.2476
}, {
	"date": "1999-12-31",
	"amount": 107091.0021
}, {
	"date": "2000-12-08",
	"amount": 139218.3031
}, {
	"date": "2001-10-15",
	"amount": 140842.0232
}, {
	"date": "2004-12-30",
	"amount": 140936.1965
}, {
	"date": "2007-06-20",
	"amount": 155018.7787
}, {
	"date": "2007-12-28",
	"amount": 170327.061
}, {
	"date": "2008-01-21",
	"amount": 175682.0549
}, {
	"date": "2008-06-26",
	"amount": 204652.0536
}, {
	"date": "2008-06-27",
	"amount": 214200.4409
}, {
	"date": "2008-10-31",
	"amount": 278460.5731
}, {
	"date": "2009-06-19",
	"amount": 278459.3862
}, {
	"date": "2009-06-22",
	"amount": 292367.4599
}, {
	"date": "2009-06-30",
	"amount": 292375.6824
}, {
	"date": "2009-10-15",
	"amount": 292411.4263
}, {
	"date": "2010-06-25",
	"amount": 292411.4263
}, {
	"date": "2010-06-28",
	"amount": 310536.9975
}, {
	"date": "2010-06-30",
	"amount": 310536.7602
}, {
	"date": "2010-09-17",
	"amount": 310536.7602
}, {
	"date": "2010-12-31",
	"amount": 310535.8511
}, {
	"date": "2011-06-30",
	"amount": 310535.8672
}, {
	"date": "2011-08-05",
	"amount": 310535.8672
}, {
	"date": "2012-12-31",
	"amount": 310535.8022
}, {
	"date": "2013-06-14",
	"amount": 310535.8672
}, {
	"date": "2013-06-20",
	"amount": 496857.3875
}, {
	"date": "2013-11-12",
	"amount": 557590.1875
}, {
	"date": "2014-01-09",
	"amount": 557590.1875
}, {
	"date": "2014-06-06",
	"amount": 557588.2183
}, {
	"date": "2014-06-12",
	"amount": 669105.862
}, {
	"date": "2014-08-29",
	"amount": 669110.5775
}, {
	"date": "2014-09-01",
	"amount": 983671.215
}, {
	"date": "2015-04-13",
	"amount": 1180405.4579
}, {
	"date": "2015-05-21",
	"amount": 1180405.4579
}, {
	"date": "2016-03-25",
	"amount": 1180405.4579
}, {
	"date": "2016-05-20",
	"amount": 1180405.458
}, {
	"date": "2016-05-23",
	"amount": 1219265.0323
}, {
	"date": "2016-06-16",
	"amount": 1463118.0387
}, {
	"date": "2017-01-09",
	"amount": 1691798.9651
}, {
	"date": "2017-12-31",
	"amount": 1691798.3372
}, {
	"date": "2018-05-18",
	"amount": 1691799.879
}, {
	"date": "2018-05-21",
	"amount": 1717024.6773
}, {
	"date": "2019-06-30",
	"amount": 1717024.5848
}, {
	"date": "2019-08-07",
	"amount": 1717090.521
}, {
	"date": "2019-09-12",
	"amount": 1889141.5083
}, {
	"date": "2019-09-18",
	"amount": 1940575.268
}, {
	"date": "2020-12-31",
	"amount": 1940575.4475
}, {
	"date": "2021-12-31",
	"amount": 1940552.195
}, {
	"date": "2022-06-30",
	"amount": 1940554.695
}, {
	"date": "2024-06-30",
	"amount": 1940561.7528
}, {
	"date": "2024-12-31",
	"amount": 1940557.185
}, {
	"date": "2025-06-30",
	"amount": 1940560.0653
}]

*/
